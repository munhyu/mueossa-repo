<!DOCTYPE html>
<html
  lang="ko"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layouts/layout}"
>
  <th:block layout:fragment="script"></th:block>

  <th:block layout:fragment="css">
    <style>
      /* pType 체크박스 라벨 기본 스타일 */
      .pType-label {
        display: inline-block;
        border: 1.5px solid #ddd;
        border-radius: 18px;
        padding: 6px 16px;
        margin: 4px 6px 4px 0;
        background: #fafafa;
        color: #444;
        cursor: pointer;
        transition: all 0.15s;
      }

      /* pType 체크박스가 선택된 경우 */
      .pType-label:has(.pType-checkbox:checked),
      .pType-label input:checked {
        border-color: #4e7cff;
        background: #e6eeff;
        color: #2350b8;
        font-weight: bold;
      }

      /* pType 체크박스에 마우스 오버 시 */
      .pType-label:hover {
        border-color: #4e7cff;
        background: #f0f6ff;
      }
    </style>
  </th:block>

  <th:block layout:fragment="header"></th:block>

  <div layout:fragment="content">
    <div id="category" class="page">
      <div class="section-title4">키워드를 선택하세요</div>

      <div class="divider3"></div>

      <form>
        <!-- 취향 선택 -->
        <div class="preference-buttons2">
          <!-- 감성 카테고리 -->
          <div>
            <label
              for="comf"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctComf == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/comfortable.jpg" alt=" " />
              <span>편한</span>
            </label>
            <input
              type="checkbox"
              id="comf"
              name="ctComf"
              value="Y"
              th:checked="${session.filteredProducts?.ctComf == 'Y'}"
            />

            <label
              for="fluffy"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctFluffy == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/fluffy.jpg" alt=" " />
              <span>폭신한</span>
            </label>
            <input
              type="checkbox"
              id="fluffy"
              name="ctFluffy"
              value="Y"
              th:checked="${session.filteredProducts?.ctFluffy == 'Y'}"
            />

            <label
              for="light"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctLight == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/light.jpg" alt=" " />
              <span>가벼운</span>
            </label>
            <input
              type="checkbox"
              id="light"
              name="ctLight"
              value="Y"
              th:checked="${session.filteredProducts?.ctLight == 'Y'}"
            />

            <label
              for="soft"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctSoft == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/soft.jpg" alt=" " />
              <span>부드러운</span>
            </label>
            <input
              type="checkbox"
              id="soft"
              name="ctSoft"
              value="Y"
              th:checked="${session.filteredProducts?.ctSoft == 'Y'}"
            />

            <label
              for="flat"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctFlat == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/flat.jpg" alt=" " />
              <span>편안한</span>
            </label>
            <input
              type="checkbox"
              id="flat"
              name="ctFlat"
              value="Y"
              th:checked="${session.filteredProducts?.ctFlat == 'Y'}"
            />

            <label
              for="pretty"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctPretty == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/pretty.jpg" alt=" " />
              <span>예쁜</span>
            </label>
            <input
              type="checkbox"
              id="pretty"
              name="ctPretty"
              value="Y"
              th:checked="${session.filteredProducts?.ctPretty == 'Y'}"
            />

            <label
              for="cute"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctCute == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/cute.jpg" alt=" " />
              <span>귀여운</span>
            </label>
            <input
              type="checkbox"
              id="cute"
              name="ctCute"
              value="Y"
              th:checked="${session.filteredProducts?.ctCute == 'Y'}"
            />

            <label
              for="neat"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctNeat == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/neat.jpg" alt=" " />
              <span>깔끔한</span>
            </label>
            <input
              type="checkbox"
              id="neat"
              name="ctNeat"
              value="Y"
              th:checked="${session.filteredProducts?.ctNeat == 'Y'}"
            />

            <label
              for="modern"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctModern == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/modern.jpg" alt=" " />
              <span>모던한</span>
            </label>
            <input
              type="checkbox"
              id="modern"
              name="ctModern"
              value="Y"
              th:checked="${session.filteredProducts?.ctModern == 'Y'}"
            />

            <label
              for="wide"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctWide == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/wide feet.jpg" alt=" " />
              <span>발볼이 넓은</span>
            </label>
            <input
              type="checkbox"
              id="wide"
              name="ctWide"
              value="Y"
              th:checked="${session.filteredProducts?.ctWide == 'Y'}"
            />

            <label
              for="narrow"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctNarrow == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/narrow feet.jpg" alt=" " />
              <span>발볼이 좁은</span>
            </label>
            <input
              type="checkbox"
              id="narrow"
              name="ctNarrow"
              value="Y"
              th:checked="${session.filteredProducts?.ctNarrow == 'Y'}"
            />

            <label
              for="standard"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctStandard == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/normal feet.jpg" alt=" " />
              <span>발볼이 보통</span>
            </label>
            <input
              type="checkbox"
              id="standard"
              name="ctStandard"
              value="Y"
              th:checked="${session.filteredProducts?.ctStandard == 'Y'}"
            />

            <label
              for="hip"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctHip == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/go-to.jpg" alt=" " />
              <span>휘뚜루마뚜루</span>
            </label>
            <input
              type="checkbox"
              id="hip"
              name="ctHip"
              value="Y"
              th:checked="${session.filteredProducts?.ctHip == 'Y'}"
            />

            <label
              for="cost"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctCost == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/value.jpg" alt=" " />
              <span>가격이 착한</span>
            </label>
            <input
              type="checkbox"
              id="cost"
              name="ctCost"
              value="Y"
              th:checked="${session.filteredProducts?.ctCost == 'Y'}"
            />

            <label
              for="strong"
              class="preference-button2"
              th:classappend="${session.filteredProducts?.ctStrong == 'Y'} ? 'selected' : ''"
            >
              <img src="/images/category-icons/durable.jpg" alt=" " />
              <span>튼튼한</span>
            </label>
            <input
              type="checkbox"
              id="strong"
              name="ctStrong"
              value="Y"
              th:checked="${session.filteredProducts?.ctStrong == 'Y'}"
            />
          </div>

          <!-- 신발 종류 구두, 부츠/워커, 스니커즈, 샌들/슬리퍼-->
          <div>
            <br />
            <div class="divider3"></div>
            <div class="section-title3">신발의 종류를 선택하세요</div>
            <input
              type="radio"
              id="shoesSneakers"
              name="pGroup"
              value="스니커즈"
              th:checked="${session.filteredProducts?.pGroup == '스니커즈'}"
            />
            <label
              for="shoesSneakers"
              class="preference-toggle"
              th:classappend="${session.filteredProducts?.pGroup == '스니커즈'} ? 'selected' : ''"
            >
              <img src="/images/shoes/sneekers.png" alt=" " />
              <span>스니커즈</span>
            </label>

            <input
              type="radio"
              id="shoesHeels"
              name="pGroup"
              value="구두"
              th:checked="${session.filteredProducts?.pGroup == '구두'}"
            />
            <label
              for="shoesHeels"
              class="preference-toggle"
              th:classappend="${session.filteredProducts?.pGroup == '구두'} ? 'selected' : ''"
            >
              <img src="/images/shoes/dress_shoes.png" alt=" " />
              <span>구두</span>
            </label>

            <input
              type="radio"
              id="shoesBoots"
              name="pGroup"
              value="부츠/워커"
              th:checked="${session.filteredProducts?.pGroup == '부츠/워커'}"
            />
            <label
              for="shoesBoots"
              class="preference-toggle"
              th:classappend="${session.filteredProducts?.pGroup == '부츠/워커'} ? 'selected' : ''"
            >
              <img src="/images/shoes/boots.png" alt=" " />
              <span>부츠/워커</span>
            </label>

            <input
              type="radio"
              id="shoesSandals"
              name="pGroup"
              value="샌들/슬리퍼"
              th:checked="${session.filteredProducts?.pGroup == '샌들/슬리퍼'}"
            />
            <label
              for="shoesSandals"
              class="preference-toggle"
              th:classappend="${session.filteredProducts?.pGroup == '샌들/슬리퍼'} ? 'selected' : ''"
            >
              <img src="/images/shoes/sandal.png" alt=" " />
              <span>샌들/슬리퍼</span>
            </label>
          </div>

          <!-- pType(세부 분류) 체크박스: 처음엔 숨김 -->
          <div id="pType-area" style="display: none; margin-top: 10px">
            <div id="pType-checkboxes"></div>
          </div>

          <div class="divider3"></div>
        </div>
      </form>
      <th:block th:replace="~{fragments/productList :: productList}"></th:block>
    </div>
  </div>

  <th:block layout:fragment="footer"></th:block>

  <th:block layout:fragment="script-footer">
    <script>
      // $(function () {
      //   const pTypeMap = {
      //     구두: [
      //       "더비 슈즈",
      //       "로퍼",
      //       "모카신",
      //       "블로퍼",
      //       "메리제인 슈즈",
      //       "플랫 슈즈",
      //       "힐/펌프스",
      //       "기타 구두",
      //       "윙 팁",
      //       "스트레이트 팁",
      //       "몽크 스트랩",
      //     ],
      //     "부츠/워커": [
      //       "미들/하프 부츠",
      //       "레인 부츠",
      //       "워커",
      //       "앵클/숏 부츠",
      //       "롱 부츠",
      //       "기타 부츠",
      //     ],
      //     "샌들/슬리퍼": [
      //       "슬라이드",
      //       "쪼리/플립플랍",
      //       "스포츠/캐주얼 샌들",
      //       "클로그",
      //       "실내화",
      //       "기타 슬리퍼",
      //       "기타 샌들",
      //       "스트랩 샌들",
      //       "스트랩 슬리퍼",
      //     ],
      //     스니커즈: [
      //       "패션스니커즈화",
      //       "캔버스/단화",
      //       "슬립온",
      //       "기타 스니커즈",
      //       "스니커즈 뮬",
      //     ],
      //   };

      //   const $filterInputs = $(".preference-buttons2 input");
      //   const $productCards = $(".product-card");
      //   const $pTypeArea = $("#pType-area");
      //   const $pTypeCheckboxes = $("#pType-checkboxes");

      //   function updatePTypeOptions() {
      //     const $selectedRadio = $(
      //       'input[type="radio"][name="pGroup"]:checked'
      //     );
      //     if ($selectedRadio.length === 0) {
      //       $pTypeArea.hide();
      //       $pTypeCheckboxes.empty();
      //       filterProducts();
      //       return;
      //     }
      //     const group = $selectedRadio.val();
      //     const types = pTypeMap[group];
      //     if (!types) {
      //       $pTypeArea.hide();
      //       $pTypeCheckboxes.empty();
      //       filterProducts();
      //       return;
      //     }
      //     // 체크박스 동적 생성
      //     let html = "";
      //     $.each(types, function (_, type) {
      //       html += `<label class="pType-label">
      //         <input type="checkbox" class="pType-checkbox" name="pType" value="${type}"> ${type}
      //       </label>`;
      //     });
      //     $pTypeCheckboxes.html(html);
      //     $pTypeArea.show();
      //     // 새로 생성된 체크박스에도 필터 이벤트 연결
      //     $pTypeCheckboxes.find("input").on("change", filterProducts);
      //     filterProducts();
      //   }

      //   function filterProducts() {
      //     const checked = {};

      //     // 기존 체크박스(감성 등)
      //     $filterInputs.each(function () {
      //       if (this.type === "checkbox" && this.checked) {
      //         checked[this.name.toLowerCase()] = this.value;
      //       }
      //     });

      //     // 라디오(신발 종류)
      //     $(".preference-toggle").each(function () {
      //       if ($(this).hasClass("selected")) {
      //         const radioInput = $("#" + $(this).attr("for"))[0];
      //         if (radioInput && radioInput.name) {
      //           checked[radioInput.name.toLowerCase()] = radioInput.value;
      //         }
      //       }
      //     });

      //     // pType 체크박스(세부 분류)
      //     const checkedTypes = [];
      //     $(".pType-checkbox:checked").each(function () {
      //       checkedTypes.push($(this).val());
      //     });

      //     $productCards.each(function () {
      //       let show = true;
      //       for (const key in checked) {
      //         const dataValue = $(this).data(key.toLowerCase());
      //         if (dataValue != checked[key]) {
      //           show = false;
      //           break;
      //         }
      //       }
      //       if (show && checkedTypes.length > 0) {
      //         const cardType = $(this).data("ptype");
      //         if ($.inArray(cardType, checkedTypes) === -1) {
      //           show = false;
      //         }
      //       }
      //       $(this).toggle(show);
      //     });
      //   }

      //   $filterInputs.on("change", function () {
      //     if (this.type === "radio" && this.name === "pGroup") {
      //       updatePTypeOptions();
      //     } else {
      //       filterProducts();
      //     }
      //   });

      //   $(".preference-toggle").on("click", function () {
      //     setTimeout(updatePTypeOptions, 10);
      //   });

      //   updatePTypeOptions();
      // });
    </script>
  </th:block>
</html>
