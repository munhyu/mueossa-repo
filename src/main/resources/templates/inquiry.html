<!-- layout 쓰는 파일-->

<!DOCTYPE html>
<html lang="ko" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layouts/layout}">
<th:block layout:fragment="script"></th:block>

<th:block layout:fragment="css">
    <style>
        h1 {
            margin-top: 20px;
            font-size: 28px;
            color: #333;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 14px;
        }

        table th,
        table td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
            text-align: left;
        }

        table th {
            background-color: #f7f7f7;
            color: #444;
            font-weight: 600;
        }

        table td {
            color: #555;
            vertical-align: top;
        }

        table tr:hover {
            background-color: #f1f9ff;
        }
    </style>
</th:block>

<th:block layout:fragment="header"></th:block>


<th:block layout:fragment="content">

    <h1>문의 하기</h1>

    <table>
        <thead>
            <tr>
                <th>제목</th>
                <th>작성자</th>
                <th>작성일</th>
                <th>내용</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <form action="/inquiryWrite" method="post">
                    <td>
                        <input type="text" name="title" placeholder="제목 입력" required>
                    </td>
                    <td>
                        <input type="text" name="writer" placeholder="작성자 입력" required>
                    </td>
                    <br>
                    <td>
                        <input type="text" name="content" placeholder="내용 입력" style="width: 100%;" required>
                    </td>
                    <td>
                        <button type="submit">작성</button>
                    </td>
                </form>
            </tr>
        </tbody>
    </table>

</th:block>

<th:block layout:fragment="footer"></th:block>


<th:block layout:fragment="script-footer">

    <script th:inline="javascript">
        document.querySelector('.id-check-button').addEventListener('click', function () {
            const id = document.querySelector('#id').value;
            if (id) {
                const formData = new URLSearchParams();
                formData.append('id', id);

                fetch('/checkId', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: formData.toString()
                })
                    .then(response => response.json())
                    .then(data => {
                        const idCheckField = document.querySelector('#id_check');
                        if (data === false) {
                            idCheckField.value = '이미 사용 중인 아이디입니다.';
                            idCheckField.style.color = 'red'; // 불가능한 경우 빨간색
                            $('button[type="submit"]').attr('disabled', true);
                        } else {
                            idCheckField.value = '사용 가능한 아이디입니다.';
                            idCheckField.style.color = 'green'; // 가능한 경우 초록색
                            $('button[type="submit"]').removeAttr('disabled')
                        }
                    })
                    .catch(error => console.error('Error:', error));
            } else {
                alert('아이디를 입력하세요.');
            }
        });

        document.querySelector('.email-check-button').addEventListener('click', function () {
            const email = document.querySelector('#email').value;
            if (email) {
                const formData = new URLSearchParams();
                formData.append('email', email);

                fetch('/checkEmail', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: formData.toString()
                })
                    .then(response => response.json())
                    .then(data => {
                        const emailCheckField = document.querySelector('#email_check');
                        if (data === false) {
                            emailCheckField.value = '이미 사용 중인 이메일입니다.';
                            emailCheckField.style.color = 'red'; // 불가능한 경우 빨간색
                            $('button[type="submit"]').attr('disabled', true);
                        } else {
                            emailCheckField.value = '사용 가능한 이메일입니다.';
                            emailCheckField.style.color = 'green'; // 가능한 경우 초록색
                            $('button[type="submit"]').removeAttr('disabled')
                        }
                    })
                    .catch(error => console.error('Error:', error));
            } else {
                alert('이메일을 입력하세요.');
            }
        });

    </script>

</th:block>

</html>